<!-- views/pages/shifts/overview.ejs -->

<style>
.card {
  background:#fff;
  border-radius:0 0 16px 16px;  /* bovenkant recht */
  box-shadow:0 2px 8px rgba(0,0,0,.06);
  padding:18px;
  max-width:1100px;
  margin:0 auto;
}
  main, body{
    margin:0!important;
    padding:0!important;
  }
</style>

<div style="max-width:1100px;margin:0 auto 24px auto;
            background:#ffffff;border-radius:0 0 16px 16px;
            box-shadow:0 8px 24px rgba(0,0,0,0.12);
            padding:24px;border:1px solid rgba(0,0,0,0.08);">

  <h1>SHIFTS • OVERVIEW</h1>

  <% if (!(items && items.length)) { %>
    <p class="muted">No shifts yet.</p>
  <% } else { %>
    <div style="overflow:auto;">
      <table style="width:100%; border-collapse:collapse; font-size:10px;">
        <thead>
          <tr style="background:#f7f7f7;">
            <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">#</th>
            <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">OP</th>
            <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">Start time</th>
            <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">End time</th>

            <!-- Nieuwe kolommen -->
            <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">SL B0210</th>
            <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">Start situation</th>
            <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">EL B0210</th>
            <th style="text-align:left; padding:8px; border-bottom:1px solid #ddd;">End situation</th>

            <th style="text-align:right; padding:8px; border-bottom:1px solid #ddd;">Produced</th>
            <th style="text-align:right; padding:8px; border-bottom:1px solid #ddd;">Downtime</th>
            <th style="text-align:right; padding:8px; border-bottom:1px solid #ddd;">QC</th>
            <th style="text-align:right; padding:8px; border-bottom:1px solid #ddd;">OEE</th>
          </tr>
        </thead>

        <% 
          // Helper: verwijdert "START:" / "END:" uit de labels voor weergave,
          // maar laat de originele waarde in de data ongemoeid.
          function cleanLabel(label) {
            if (!label) return '';
            return label
              .replace(/^START:\s*/i, '')
              .replace(/^END:\s*/i, '');
          }
        %>

        <tbody>
          <% items.forEach((s)=>{ %>
            <tr>
              <td style="padding:8px; border-bottom:1px solid #eee;"><%= s.id %></td>
              <td style="padding:8px; border-bottom:1px solid #eee;"><%= s.operator || '' %></td>
              <td style="padding:8px; border-bottom:1px solid #eee; white-space:nowrap;"><%= cleanLabel(s.startLabel) %></td>
              <td style="padding:8px; border-bottom:1px solid #eee; white-space:nowrap;"><%= cleanLabel(s.endLabel) %></td>

              <!-- Nieuwe velden -->
              <td style="padding:8px; border-bottom:1px solid #eee; text-align:left;">
                <%= (s.startLevel ?? '') %>m³
              </td>
              <td style="padding:8px; border-bottom:1px solid #eee;">
                <%= s.startDescription || '' %>
              </td>
              <td style="padding:8px; border-bottom:1px solid #eee; text-align:left;">
                <%= (s.endLevel ?? '') %>m³
              </td>
              <td style="padding:8px; border-bottom:1px solid #eee;">
                <%= s.endDescription || '' %>
              </td>

              <td style="padding:8px; border-bottom:1px solid #eee; text-align:right;">
                <%= (s.produced ?? 0) %>kg
              </td>
              <td style="padding:8px; border-bottom:1px solid #eee; text-align:right;">
                <%= (s.downtime ?? 0) %>min
              </td>
              <td style="padding:8px; border-bottom:1px solid #eee; text-align:right;">
                <%= (s.qc ?? 0) %>%
              </td>
              <td style="padding:8px; border-bottom:1px solid #eee; text-align:right;">
                <%= (s.oee ? s.oee.toFixed(2) : '0.00') %>%</td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>
